using Football.Domain.ValueObjects;
using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Metadata.Builders;

namespace Football.Infrastructure.Persistence.Configurations;

public class TimeConfiguration : IEntityTypeConfiguration<Time>
{
    public void Configure(EntityTypeBuilder<Time> entityTypeBuilder)
    {
        entityTypeBuilder.HasKey(e => e.GameId)
                    .HasName("PRIMARY");

        entityTypeBuilder.ToTable("time");

        entityTypeBuilder.Property(e => e.GameId)
            .ValueGeneratedNever()
            .HasColumnName("game_id");

        entityTypeBuilder.Property(e => e.Quarter).HasColumnName("quarter");

        entityTypeBuilder.Property(e => e.QuarterSecondsRemaining).HasColumnName("quarter_seconds_remaining");

        entityTypeBuilder.HasOne(d => d.Game)
            .WithOne(p => p.Time)
            .HasForeignKey<TimeEntity>(d => d.GameId)
            .OnDelete(DeleteBehavior.ClientSetNull)
            .HasConstraintName("time_ibfk_1");
    }
}
